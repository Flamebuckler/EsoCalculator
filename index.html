<!doctype html>
<html lang="en">
	<head>
		<link
			rel="stylesheet"
			type="text/css"
			href="https://eso-hub.com/css/external/tooltips.css" />
		<script
			src="https://eso-hub.com/js/external/tooltips.js"
			defer=""></script>
		<meta charset="utf-8" />
		<meta
			name="viewport"
			content="width=device-width,initial-scale=1" />
		<meta
			http-equiv="Cache-Control"
			content="no-store, no-cache, must-revalidate" />
		<meta
			http-equiv="Pragma"
			content="no-cache" />
		<meta
			http-equiv="Expires"
			content="0" />
		<script>
			const workerUrl = 'https://page-counter.flamebuckler.workers.dev';
			const pageId = 'ESO-Calculator'; // Unique identifier for this page

			fetch(`${workerUrl}/increment?page=${encodeURIComponent(pageId)}`, {
				method: 'POST',
				keepalive: true,
			});

			(function () {
				// Simple runtime cache-busting for local assets on GitHub Pages.
				// Appends ?v=<timestamp> to relative local CSS/JS files so browsers fetch fresh copies.
				var v = Date.now();
				// Update matching stylesheet hrefs (e.g. styles.css)
				try {
					var links = document.getElementsByTagName('link');
					for (var i = 0; i < links.length; i++) {
						var l = links[i];
						if (
							l.rel === 'stylesheet' &&
							l.href &&
							/(^|\/)styles\.css(\?|$)/.test(l.getAttribute('href'))
						) {
							l.href = l.getAttribute('href').split('?')[0] + '?v=' + v;
						}
					}
					// Update scripts with src matching app.js (will be encountered later in the document)
					var scripts = document.getElementsByTagName('script');
					for (var j = 0; j < scripts.length; j++) {
						var s = scripts[j];
						if (s.src && /(^|\/)app\.js(\?|$)/.test(s.getAttribute('src'))) {
							s.src = s.getAttribute('src').split('?')[0] + '?v=' + v;
						}
					}
				} catch (e) {
					console.warn('cache-bust failed', e);
				}
				// Expose version for other scripts if needed
				window.__cacheBust = v;
			})();
		</script>
		<title>ESO Calculator</title>
		<!-- styles.css is generated from styles.scss using the Sass compiler -->
		<link
			rel="stylesheet"
			href="styles.css" />
	</head>
	<body>
		<header>
			<h1>ESO Calculator</h1>
			<p>Calculate your values easily</p>
		</header>
		<main class="container">
			<div class="card">
				<div
					id="controls"
					class="controls">
					<a
						href="?list=penetration"
						id="link-list-pen"
						class="tool"
						><span class="tool-name">Penetration</span></a
					>
					<a
						href="?list=criticalDamage"
						id="link-list-critdamage"
						class="tool"
						><span class="tool-name">Critical Damage</span></a
					>
					<!--<button id="share-btn" class="list-btn share">Share</button>-->
				</div>

				<table
					id="items-table"
					class="results-table">
					<thead>
						<tr>
							<th width="10"></th>
							<th width="10"></th>
							<th></th>
							<th></th>
						</tr>
					</thead>
					<tbody>
						<!-- rows are populated from items.json via app.js -->
					</tbody>
				</table>

				<div id="summary">
					<div><span id="summary-text">Gesamtsumme: </span><span id="total">0</span></div>
					<div id="save-text">(Selected values are stored in the lokal browser storage)</div>
				</div>
			</div>
		</main>

		<script src="utils.js"></script>
		<script src="app.js"></script>
	</body>
</html>
